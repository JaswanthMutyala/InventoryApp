{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/inventory-app/app/history/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\n// Helper function to format date only (no time)\r\nconst formatDate = (dateString) => {\r\n  if (!dateString) return '-';\r\n  const date = new Date(dateString);\r\n  return date.toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: '2-digit',\r\n    day: '2-digit'\r\n  });\r\n};\r\n\r\nexport default function TransactionHistory() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState(null);\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [products, setProducts] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [filters, setFilters] = useState({\r\n    userName: '',\r\n    productName: 'All',\r\n    date: '',\r\n    type: 'All'\r\n  });\r\n\r\n  useEffect(() => {\r\n    const storedUser = localStorage.getItem('user');\r\n    if (!storedUser) {\r\n      router.push('/login');\r\n    } else {\r\n      const userData = JSON.parse(storedUser);\r\n      setUser(userData);\r\n      fetchData(userData);\r\n    }\r\n  }, [router]);\r\n\r\n  const fetchData = async (userData) => {\r\n    try {\r\n      const [transactionsRes, productsRes] = await Promise.all([\r\n        fetch('/api/transactions'),\r\n        fetch('/api/products')\r\n      ]);\r\n\r\n      const transactionsData = await transactionsRes.json();\r\n      const productsData = await productsRes.json();\r\n      \r\n      setProducts(productsData);\r\n      setTransactions(transactionsData);\r\n    } catch (error) {\r\n      console.error('Failed to fetch data', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFilterChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFilters(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const filteredTransactions = transactions.filter(tx => {\r\n    const productName = products.find(p => p.id === tx.product_id)?.name || 'Unknown Product';\r\n    \r\n    return (\r\n      (filters.userName === '' || tx.user_name?.toLowerCase().includes(filters.userName.toLowerCase())) &&\r\n      (filters.productName === 'All' || productName === filters.productName) &&\r\n      (filters.date === '' || formatDate(tx.timestamp) === filters.date) &&\r\n      (filters.type === 'All' || tx.type === filters.type)\r\n    );\r\n  });\r\n\r\n  if (!user || isLoading) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: '1000px', margin: '0 auto' }}>\r\n      <h1 style={{ fontSize: '1.5rem', fontWeight: 600, marginBottom: '1.5rem', color: '#1e293b' }}>\r\n        Transaction History\r\n      </h1>\r\n\r\n      {/* Filters */}\r\n      <div className=\"card\" style={{ marginBottom: '1.5rem', display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n          {/* User Name Filter */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', fontWeight: 500, color: '#374151' }}>User Name</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"userName\"\r\n              value={filters.userName}\r\n              onChange={handleFilterChange}\r\n              className=\"input\"\r\n              placeholder=\"Search...\"\r\n              style={{ padding: '0.625rem 0.75rem', fontSize: '0.875rem' }}\r\n            />\r\n          </div>\r\n\r\n          {/* Product Filter */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', fontWeight: 500, color: '#374151' }}>Product</label>\r\n            <select\r\n              name=\"productName\"\r\n              value={filters.productName}\r\n              onChange={handleFilterChange}\r\n              className=\"input\"\r\n              style={{ padding: '0.625rem 0.75rem', fontSize: '0.875rem', cursor: 'pointer' }}\r\n            >\r\n              <option value=\"All\">All</option>\r\n              {products.map(product => (\r\n                <option key={product.id} value={product.name}>{product.name}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Date Filter */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', fontWeight: 500, color: '#374151' }}>Date</label>\r\n            <input\r\n              type=\"date\"\r\n              name=\"date\"\r\n              value={filters.date}\r\n              onChange={handleFilterChange}\r\n              className=\"input\"\r\n              style={{ padding: '0.625rem 0.75rem', fontSize: '0.875rem' }}\r\n            />\r\n          </div>\r\n\r\n          {/* Type Filter */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\r\n            <label style={{ fontSize: '0.875rem', fontWeight: 500, color: '#374151' }}>Type</label>\r\n            <select\r\n              name=\"type\"\r\n              value={filters.type}\r\n              onChange={handleFilterChange}\r\n              className=\"input\"\r\n              style={{ padding: '0.625rem 0.75rem', fontSize: '0.875rem', cursor: 'pointer' }}\r\n            >\r\n              <option value=\"All\">All</option>\r\n              <option value=\"CHECKOUT\">Checkout</option>\r\n              <option value=\"CHECKIN\">Return</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Transactions Table */}\r\n      <div className=\"card\">\r\n        <h2 style={{ fontSize: '1rem', fontWeight: 600, marginBottom: '1rem', color: '#1e293b' }}>\r\n          Transaction History\r\n        </h2>\r\n        \r\n        {filteredTransactions.length > 0 ? (\r\n          <div style={{ overflowX: 'auto' }}>\r\n            <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n              <thead>\r\n                <tr style={{ borderBottom: '1px solid #e2e8f0', backgroundColor: '#f8fafc' }}>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontSize: '0.875rem', fontWeight: 600, color: '#64748b' }}>User Name</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'left', fontSize: '0.875rem', fontWeight: 600, color: '#64748b' }}>Product</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: 600, color: '#64748b' }}>Quantity</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: 600, color: '#64748b' }}>Type</th>\r\n                  <th style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', fontWeight: 600, color: '#64748b' }}>Date</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredTransactions.map((tx, index) => {\r\n                  const productName = products.find(p => p.id === tx.product_id)?.name || 'Unknown Product';\r\n                  const typeLabel = tx.type === 'CHECKOUT' ? 'took' : 'return';\r\n                  \r\n                  return (\r\n                    <tr key={index} style={{ borderBottom: '1px solid #e2e8f0' }}>\r\n                      <td style={{ padding: '0.75rem', fontSize: '0.875rem', color: '#1e293b' }}>{tx.user_name || '-'}</td>\r\n                      <td style={{ padding: '0.75rem', fontSize: '0.875rem', color: '#1e293b' }}>{productName}</td>\r\n                      <td style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', color: '#1e293b' }}>{tx.quantity}</td>\r\n                      <td style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', color: '#1e293b' }}>{typeLabel}</td>\r\n                      <td style={{ padding: '0.75rem', textAlign: 'center', fontSize: '0.875rem', color: '#1e293b' }}>{formatDate(tx.timestamp)}</td>\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        ) : (\r\n          <div style={{ padding: '2rem', textAlign: 'center', color: '#64748b' }}>\r\n            <p>No transactions yet</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}