module.exports=[67760,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("all"),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)("all"),[r,s]=(0,c.useState)(""),t=(0,d.useRouter)();(0,c.useEffect)(()=>{"admin"!==JSON.parse(localStorage.getItem("user")||"{}").role?t.push("/"):(k(!0),u())},[]);let u=async()=>{try{let a=JSON.parse(localStorage.getItem("user")||"{}"),b=await fetch("/api/access-logs",{headers:{Authorization:`Bearer ${a.id}`}});if(b.ok){let a=await b.json();e(a)}else i("Failed to fetch access logs")}catch(a){i("Error fetching access logs")}finally{g(!1)}},v=a.filter(a=>"all"===l||a.role===l).filter(a=>{if(!n.trim())return!0;let b=n.toLowerCase();return(a.name||"").toLowerCase().includes(b)||(a.student_id||"").toLowerCase().includes(b)}).filter(a=>{if("all"===p)return!0;let b=new Date(a.accessed_at);if("custom"===p&&r)return b.toISOString().slice(0,10)===r;let c=new Date,d=new Date(b.getFullYear(),b.getMonth(),b.getDate()),e=(new Date(c.getFullYear(),c.getMonth(),c.getDate())-d)/864e5;return"today"===p?0===e:"7"===p?e>=0&&e<=7:"30"!==p||e>=0&&e<=30}),w=a.filter(a=>"admin"===a.role).length,x=a.filter(a=>"member"===a.role).length,y=new Set(a.filter(a=>"admin"===a.role).map(a=>a.user_id)).size,z=new Set(a.filter(a=>"member"===a.role).map(a=>a.user_id)).size;return j?(0,b.jsxs)("div",{className:"container",style:{padding:"2rem 1rem",maxWidth:"1200px"},children:[(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold",marginBottom:"1rem"},children:"Access Logs"}),(0,b.jsx)("p",{style:{color:"#666",marginBottom:"1.5rem"},children:"View all members and admins who have accessed the system"}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,b.jsxs)("div",{style:{backgroundColor:"#dbeafe",border:"2px solid #3b82f6",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6"},children:y}),(0,b.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Unique Admins"}),(0,b.jsxs)("div",{style:{color:"#999",fontSize:"0.75rem",marginTop:"0.25rem"},children:[w," total accesses"]})]}),(0,b.jsxs)("div",{style:{backgroundColor:"#dcfce7",border:"2px solid #22c55e",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#22c55e"},children:z}),(0,b.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Unique Members"}),(0,b.jsxs)("div",{style:{color:"#999",fontSize:"0.75rem",marginTop:"0.25rem"},children:[x," total accesses"]})]}),(0,b.jsxs)("div",{style:{backgroundColor:"#f3e8ff",border:"2px solid #a855f7",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,b.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#a855f7"},children:a.length}),(0,b.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Total Accesses"})]})]})]}),h&&(0,b.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fca5a5",color:"#dc2626",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:h}),(0,b.jsxs)("div",{style:{marginBottom:"1.5rem",display:"flex",flexWrap:"wrap",gap:"0.75rem",alignItems:"center"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Role:"}),(0,b.jsxs)("select",{value:l,onChange:a=>m(a.target.value),style:{padding:"0.4rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"0.9rem",cursor:"pointer"},children:[(0,b.jsx)("option",{value:"all",children:"All"}),(0,b.jsx)("option",{value:"admin",children:"Admin only"}),(0,b.jsx)("option",{value:"member",children:"Member only"})]})]}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"1 1 220px"},children:[(0,b.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Search:"}),(0,b.jsx)("input",{type:"text",placeholder:"Name or roll number",value:n,onChange:a=>o(a.target.value),style:{flex:"1 1 auto",minWidth:"180px",padding:"0.4rem 0.75rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.9rem"}})]}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,b.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Date:"}),(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),style:{padding:"0.4rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"0.9rem",cursor:"pointer"},children:[(0,b.jsx)("option",{value:"all",children:"All time"}),(0,b.jsx)("option",{value:"today",children:"Today"}),(0,b.jsx)("option",{value:"7",children:"Last 7 days"}),(0,b.jsx)("option",{value:"30",children:"Last 30 days"}),(0,b.jsx)("option",{value:"custom",children:"Specific date…"})]}),"custom"===p&&(0,b.jsx)("input",{type:"date",value:r,onChange:a=>{s((a.target.value||"").slice(0,10))},style:{marginLeft:"0.5rem",padding:"0.4rem 0.6rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.85rem"}})]})]}),f?(0,b.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading..."}):0===a.length?(0,b.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#666"},children:"No access logs found"}):(0,b.jsx)("div",{style:{overflowX:"auto"},children:(0,b.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",borderRadius:"var(--radius)",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{style:{backgroundColor:"#f3f4f6",borderBottom:"2px solid #e5e7eb"},children:[(0,b.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Name"}),(0,b.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Roll Number"}),(0,b.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Role"}),(0,b.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Date"})]})}),(0,b.jsx)("tbody",{children:v.map(a=>(0,b.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,b.jsx)("td",{style:{padding:"1rem"},children:a.name}),(0,b.jsx)("td",{style:{padding:"1rem"},children:a.student_id}),(0,b.jsx)("td",{style:{padding:"1rem"},children:(0,b.jsx)("span",{style:{display:"inline-block",padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.875rem",fontWeight:"600",backgroundColor:"admin"===a.role?"#fef3c7":"#dbeafe",color:"admin"===a.role?"#b45309":"#1e40af"},children:"admin"===a.role?"Admin":"Member"})}),(0,b.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",fontFamily:"monospace"},children:new Date(a.accessed_at).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},a.id))})]})}),(0,b.jsx)("div",{style:{marginTop:"2rem",textAlign:"center"},children:(0,b.jsxs)("span",{style:{color:"#999",fontSize:"0.875rem"},children:["Showing ",v.length," of ",a.length," total accesses"]})}),(0,b.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,b.jsx)("a",{href:"/members",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500",marginRight:"2rem"},children:"→ Back to Members"}),(0,b.jsx)("a",{href:"/",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500"},children:"← Back to Dashboard"})]})]}):null}a.s(["default",()=>e])}];

//# sourceMappingURL=app_access-logs_page_70034e2e.js.map