module.exports=[30100,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);function f(){let a=(0,d.useRouter)(),[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)({totalProducts:0,lowStock:0,recentTransactions:[],userCheckouts:[],userTransactions:[]}),[j,k]=(0,c.useState)(!0);(0,c.useEffect)(()=>{let b=localStorage.getItem("user");if(b){let a=JSON.parse(b);g(a),l(a)}else a.push("/login")},[a]);let l=async a=>{try{let[b,c,d]=await Promise.all([fetch("/api/products"),fetch(`/api/transactions/outstanding?user_id=${a.id}`),fetch("admin"===a.role?"/api/transactions":`/api/transactions?user_id=${a.id}`)]),e=await b.json(),f=await c.json(),g=await d.json(),h=g.map(a=>({...a,product_name:e.find(b=>b.id===a.product_id)?.name||"Unknown Product"})).sort((a,b)=>new Date(b.timestamp)-new Date(a.timestamp)).slice(0,5);i({totalProducts:e.length,lowStock:e.filter(a=>a.quantity<5).length,recentTransactions:h,userCheckouts:f.map(b=>{var c;let d=e.find(a=>a.id===b.product_id),f=g.find(c=>c.product_id===b.product_id&&c.user_id===a.id&&"CHECKOUT"===c.type);return{...b,product_name:d?.name||"Unknown Product",checkout_date:f&&(c=f.timestamp)?new Date(c).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",status:"CHECKOUT"}}),userTransactions:h})}catch(a){console.error("Failed to fetch stats",a)}finally{k(!1)}};if(!f||j)return null;let m="admin"===f.role;return(0,b.jsxs)("div",{children:[(0,b.jsxs)("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",paddingBottom:"1.5rem",borderBottom:"1px solid #e2e8f0"},children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{style:{fontSize:"1.5rem",fontWeight:600,color:"#1e293b",margin:0,marginBottom:"0.5rem"},children:["Welcome ",f.name]}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.95rem",color:"#64748b"},children:[(0,b.jsxs)("span",{children:["Student ID: ",f.student_id]}),(0,b.jsx)("span",{className:`badge ${m?"badge-primary":"badge-success"}`,children:m?"Admin":"member"})]})]}),(0,b.jsx)("button",{onClick:()=>{localStorage.removeItem("user"),a.push("/login")},className:"btn btn-secondary",style:{padding:"0.35rem 0.6rem !important",fontSize:"0.7rem !important",height:"auto",minHeight:"24px",lineHeight:"1.2",width:"auto"},children:"Logout"})]}),(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsx)("h2",{style:{fontSize:"1rem",fontWeight:600,color:"#1e293b",marginBottom:"1rem"},children:"Overview"}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,b.jsx)("span",{style:{color:"#64748b",fontSize:"0.95rem"},children:"Total Products"}),(0,b.jsx)("span",{style:{fontSize:"1.75rem",fontWeight:700,color:"#3b82f6"},children:h.totalProducts})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,b.jsx)("span",{style:{color:"#64748b",fontSize:"0.95rem"},children:"Low Stock Items"}),(0,b.jsx)("span",{style:{fontSize:"1.75rem",fontWeight:700,color:h.lowStock>0?"#dc2626":"#22c55e"},children:h.lowStock})]})]}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,b.jsx)(e.default,{href:"/transactions",className:"btn btn-primary",style:{textDecoration:"none",textAlign:"center"},children:"Take / Return"}),m&&(0,b.jsx)(e.default,{href:"/inventory",className:"btn btn-secondary",style:{textDecoration:"none",textAlign:"center"},children:"Manage"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-gray-800",children:"Current Checkouts"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Items currently checked out under your name"})]}),h.userCheckouts.length>0?(0,b.jsxs)("div",{className:"overflow-x-auto",children:[(0,b.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),(0,b.jsx)("th",{scope:"col",className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Checked Out"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.userCheckouts.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:a.product_name}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-orange-600 font-medium",children:a.outstanding}),(0,b.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-gray-500",children:a.checkout_date})]},`${a.product_id}-${a.checkout_date}`))})]}),(0,b.jsxs)("div",{className:"px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,b.jsx)(e.default,{href:"/transactions",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Manage Checkouts"}),(0,b.jsx)(e.default,{href:"/history",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"View Full History â†’"})]})]}):(0,b.jsxs)("div",{className:"p-6 text-center",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:"No items currently checked out"}),(0,b.jsx)(e.default,{href:"/history",className:"btn btn-primary",style:{display:"inline-block",textDecoration:"none",textAlign:"center"},children:"View Transaction History"})]})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_page_b06da40b.js.map