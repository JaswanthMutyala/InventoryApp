(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94718,e=>{"use strict";var r=e.i(43476),t=e.i(71645),l=e.i(18566);function i(){let[e,i]=(0,t.useState)([]),[s,o]=(0,t.useState)(!0),[d,n]=(0,t.useState)(""),[a,c]=(0,t.useState)(!1),[m,g]=(0,t.useState)("all"),[h,f]=(0,t.useState)(""),[x,u]=(0,t.useState)("all"),[p,y]=(0,t.useState)(""),b=(0,l.useRouter)();(0,t.useEffect)(()=>{"admin"!==JSON.parse(localStorage.getItem("user")||"{}").role?b.push("/"):(c(!0),j())},[]);let j=async()=>{try{let e=JSON.parse(localStorage.getItem("user")||"{}"),r=await fetch("/api/access-logs",{headers:{Authorization:`Bearer ${e.id}`}});if(r.ok){let e=await r.json();i(e)}else n("Failed to fetch access logs")}catch(e){n("Error fetching access logs")}finally{o(!1)}},v=e.filter(e=>"all"===m||e.role===m).filter(e=>{if(!h.trim())return!0;let r=h.toLowerCase();return(e.name||"").toLowerCase().includes(r)||(e.student_id||"").toLowerCase().includes(r)}).filter(e=>{if("all"===x)return!0;let r=new Date(e.accessed_at);if("custom"===x&&p)return r.toISOString().slice(0,10)===p;let t=new Date,l=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=(new Date(t.getFullYear(),t.getMonth(),t.getDate())-l)/864e5;return"today"===x?0===i:"7"===x?i>=0&&i<=7:"30"!==x||i>=0&&i<=30}),S=e.filter(e=>"admin"===e.role).length,z=e.filter(e=>"member"===e.role).length,A=new Set(e.filter(e=>"admin"===e.role).map(e=>e.user_id)).size,w=new Set(e.filter(e=>"member"===e.role).map(e=>e.user_id)).size;return a?(0,r.jsxs)("div",{className:"container",style:{padding:"2rem 1rem",maxWidth:"1200px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,r.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold",marginBottom:"1rem"},children:"Access Logs"}),(0,r.jsx)("p",{style:{color:"#666",marginBottom:"1.5rem"},children:"View all members and admins who have accessed the system"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{backgroundColor:"#dbeafe",border:"2px solid #3b82f6",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6"},children:A}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Unique Admins"}),(0,r.jsxs)("div",{style:{color:"#999",fontSize:"0.75rem",marginTop:"0.25rem"},children:[S," total accesses"]})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#dcfce7",border:"2px solid #22c55e",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#22c55e"},children:w}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Unique Members"}),(0,r.jsxs)("div",{style:{color:"#999",fontSize:"0.75rem",marginTop:"0.25rem"},children:[z," total accesses"]})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#f3e8ff",border:"2px solid #a855f7",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#a855f7"},children:e.length}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Total Accesses"})]})]})]}),d&&(0,r.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fca5a5",color:"#dc2626",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:d}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem",display:"flex",flexWrap:"wrap",gap:"0.75rem",alignItems:"center"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Role:"}),(0,r.jsxs)("select",{value:m,onChange:e=>g(e.target.value),style:{padding:"0.4rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"0.9rem",cursor:"pointer"},children:[(0,r.jsx)("option",{value:"all",children:"All"}),(0,r.jsx)("option",{value:"admin",children:"Admin only"}),(0,r.jsx)("option",{value:"member",children:"Member only"})]})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flex:"1 1 220px"},children:[(0,r.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Search:"}),(0,r.jsx)("input",{type:"text",placeholder:"Name or roll number",value:h,onChange:e=>f(e.target.value),style:{flex:"1 1 auto",minWidth:"180px",padding:"0.4rem 0.75rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.9rem"}})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("label",{style:{fontWeight:"500",fontSize:"0.9rem"},children:"Date:"}),(0,r.jsxs)("select",{value:x,onChange:e=>u(e.target.value),style:{padding:"0.4rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"0.9rem",cursor:"pointer"},children:[(0,r.jsx)("option",{value:"all",children:"All time"}),(0,r.jsx)("option",{value:"today",children:"Today"}),(0,r.jsx)("option",{value:"7",children:"Last 7 days"}),(0,r.jsx)("option",{value:"30",children:"Last 30 days"}),(0,r.jsx)("option",{value:"custom",children:"Specific date…"})]}),"custom"===x&&(0,r.jsx)("input",{type:"date",value:p,onChange:e=>{y((e.target.value||"").slice(0,10))},style:{marginLeft:"0.5rem",padding:"0.4rem 0.6rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.85rem"}})]})]}),s?(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading..."}):0===e.length?(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#666"},children:"No access logs found"}):(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",borderRadius:"var(--radius)",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{backgroundColor:"#f3f4f6",borderBottom:"2px solid #e5e7eb"},children:[(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Name"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Roll Number"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Role"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Date"})]})}),(0,r.jsx)("tbody",{children:v.map(e=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,r.jsx)("td",{style:{padding:"1rem"},children:e.name}),(0,r.jsx)("td",{style:{padding:"1rem"},children:e.student_id}),(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)("span",{style:{display:"inline-block",padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.875rem",fontWeight:"600",backgroundColor:"admin"===e.role?"#fef3c7":"#dbeafe",color:"admin"===e.role?"#b45309":"#1e40af"},children:"admin"===e.role?"Admin":"Member"})}),(0,r.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem",fontFamily:"monospace"},children:new Date(e.accessed_at).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata"})})]},e.id))})]})}),(0,r.jsx)("div",{style:{marginTop:"2rem",textAlign:"center"},children:(0,r.jsxs)("span",{style:{color:"#999",fontSize:"0.875rem"},children:["Showing ",v.length," of ",e.length," total accesses"]})}),(0,r.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,r.jsx)("a",{href:"/members",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500",marginRight:"2rem"},children:"→ Back to Members"}),(0,r.jsx)("a",{href:"/",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500"},children:"← Back to Dashboard"})]})]}):null}e.s(["default",()=>i])}]);