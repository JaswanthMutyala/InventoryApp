(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,81694,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),n=e.i(22016);function i(){let e=(0,r.useRouter)(),[i,a]=(0,s.useState)(null),[o,c]=(0,s.useState)({totalProducts:0,lowStock:0,recentTransactions:[],userCheckouts:[],userTransactions:[]}),[l,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let t=localStorage.getItem("user");if(t){let e=JSON.parse(t);a(e),m(e)}else e.push("/login")},[e]);let m=async e=>{try{let[t,s,r]=await Promise.all([fetch("/api/products"),fetch(`/api/transactions/outstanding?user_id=${e.id}`),fetch("admin"===e.role?"/api/transactions":`/api/transactions?user_id=${e.id}`)]),n=await t.json(),i=await s.json(),a=await r.json(),o=a.map(e=>({...e,product_name:n.find(t=>t.id===e.product_id)?.name||"Unknown Product"})).sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)).slice(0,5);c({totalProducts:n.length,lowStock:n.filter(e=>e.quantity<5).length,recentTransactions:o,userCheckouts:i.map(t=>{var s;let r=n.find(e=>e.id===t.product_id),i=a.find(s=>s.product_id===t.product_id&&s.user_id===e.id&&"CHECKOUT"===s.type);return{...t,product_name:r?.name||"Unknown Product",checkout_date:i&&(s=i.timestamp)?new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",status:"CHECKOUT"}}),userTransactions:o})}catch(e){console.error("Failed to fetch stats",e)}finally{d(!1)}};if(!i||l)return null;let u="admin"===i.role;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",paddingBottom:"1.5rem",borderBottom:"1px solid #e2e8f0"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{style:{fontSize:"1.5rem",fontWeight:600,color:"#1e293b",margin:0,marginBottom:"0.5rem"},children:["Welcome ",i.name]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",fontSize:"0.95rem",color:"#64748b"},children:[(0,t.jsxs)("span",{children:["Student ID: ",i.student_id]}),(0,t.jsx)("span",{className:`badge ${u?"badge-primary":"badge-success"}`,children:u?"Admin":"member"})]})]}),(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("user"),e.push("/login")},className:"btn btn-secondary",style:{padding:"0.35rem 0.6rem !important",fontSize:"0.7rem !important",height:"auto",minHeight:"24px",lineHeight:"1.2",width:"auto"},children:"Logout"})]}),(0,t.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,t.jsx)("h2",{style:{fontSize:"1rem",fontWeight:600,color:"#1e293b",marginBottom:"1rem"},children:"Overview"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,t.jsx)("span",{style:{color:"#64748b",fontSize:"0.95rem"},children:"Total Products"}),(0,t.jsx)("span",{style:{fontSize:"1.75rem",fontWeight:700,color:"#3b82f6"},children:o.totalProducts})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{color:"#64748b",fontSize:"0.95rem"},children:"Low Stock Items"}),(0,t.jsx)("span",{style:{fontSize:"1.75rem",fontWeight:700,color:o.lowStock>0?"#dc2626":"#22c55e"},children:o.lowStock})]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,t.jsx)(n.default,{href:"/transactions",className:"btn btn-primary",style:{textDecoration:"none",textAlign:"center"},children:"Take / Return"}),u&&(0,t.jsx)(n.default,{href:"/inventory",className:"btn btn-secondary",style:{textDecoration:"none",textAlign:"center"},children:"Manage"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-gray-800",children:"Current Checkouts"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Items currently checked out under your name"})]}),o.userCheckouts.length>0?(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qty"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Checked Out"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.userCheckouts.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:e.product_name}),(0,t.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-orange-600 font-medium",children:e.outstanding}),(0,t.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-gray-500",children:e.checkout_date})]},`${e.product_id}-${e.checkout_date}`))})]}),(0,t.jsxs)("div",{className:"px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,t.jsx)(n.default,{href:"/transactions",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Manage Checkouts"}),(0,t.jsx)(n.default,{href:"/history",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"View Full History â†’"})]})]}):(0,t.jsxs)("div",{className:"p-6 text-center",children:[(0,t.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:"No items currently checked out"}),(0,t.jsx)(n.default,{href:"/history",className:"btn btn-primary",style:{display:"inline-block",textDecoration:"none",textAlign:"center"},children:"View Transaction History"})]})]})]})}e.s(["default",()=>i])}]);