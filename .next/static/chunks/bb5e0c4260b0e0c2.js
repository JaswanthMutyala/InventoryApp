(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6779,e=>{"use strict";var r=e.i(43476),t=e.i(71645),d=e.i(18566);function o(){let[e,o]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[s,a]=(0,t.useState)(""),[l,c]=(0,t.useState)(!1),[m,g]=(0,t.useState)(""),[u,b]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[f,x]=(0,t.useState)(!1),[y,j]=(0,t.useState)(!1),[v,S]=(0,t.useState)({name:"",student_id:"",password:""}),[w,C]=(0,t.useState)(""),[k,R]=(0,t.useState)("desc"),[z,W]=(0,t.useState)(!1),A=(0,d.useRouter)();(0,t.useEffect)(()=>{"admin"!==JSON.parse(localStorage.getItem("user")||"{}").role?A.push("/"):(c(!0),B())},[]);let B=async()=>{try{let e=JSON.parse(localStorage.getItem("user")||"{}"),r=await fetch("/api/users",{headers:{Authorization:`Bearer ${e.id}`}});if(r.ok){let e=await r.json();o(e)}else a("Failed to fetch users")}catch(e){a("Error fetching users")}finally{n(!1)}},N=async()=>{if(!m)return void a("Please enter admin password");x(!0),a("");try{let r=JSON.parse(localStorage.getItem("user")||"{}"),t=await fetch("/api/users",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.id}`},body:JSON.stringify({userId:h.id,password:m})});if(t.ok)o(e.filter(e=>e.id!==h.id)),b(!1),p(null),g("");else{let e=await t.json();a(e.error||"Failed to delete user")}}catch(e){a("Error deleting user")}finally{x(!1)}},T=async()=>{if(!v.name||!v.student_id||!v.password)return void a("Please fill in all fields");W(!0),a("");try{let r=JSON.parse(localStorage.getItem("user")||"{}"),t=await fetch("/api/users/add",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.id}`},body:JSON.stringify({name:v.name,student_id:v.student_id,password:v.password})});if(t.ok){let r=await t.json();o([...e,r]),j(!1),S({name:"",student_id:"",password:""})}else{let e=await t.json();a(e.error||"Failed to add member")}}catch(e){a("Error adding member")}finally{W(!1)}},O=e.filter(e=>"admin"===e.role).length,I=e.filter(e=>"member"===e.role).length,M=[...e].filter(e=>{if(!w.trim())return!0;let r=w.toLowerCase();return e.name.toLowerCase().includes(r)||(e.student_id||"").toLowerCase().includes(r)}).sort((e,r)=>{let t=new Date(e.created_at),d=new Date(r.created_at);return"desc"===k?d-t:t-d});return l?(0,r.jsxs)("div",{className:"container",style:{padding:"2rem 1rem",maxWidth:"1200px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,r.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold",marginBottom:"1rem"},children:"Members Management"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,r.jsxs)("div",{style:{backgroundColor:"#dbeafe",border:"2px solid #3b82f6",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#3b82f6"},children:O}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Admin Users"})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#dcfce7",border:"2px solid #22c55e",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#22c55e"},children:I}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Member Users"})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#f3e8ff",border:"2px solid #a855f7",borderRadius:"var(--radius)",padding:"1.5rem",textAlign:"center"},children:[(0,r.jsx)("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#a855f7"},children:e.length}),(0,r.jsx)("div",{style:{color:"#666",fontSize:"0.875rem",marginTop:"0.5rem"},children:"Total Users"})]})]})]}),(0,r.jsx)("div",{style:{marginBottom:"2rem",textAlign:"center"},children:(0,r.jsx)("button",{onClick:()=>j(!0),style:{backgroundColor:"#22c55e",color:"#fff",border:"none",padding:"0.75rem 2rem",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"1rem",fontWeight:"600",transition:"background-color 0.2s"},onMouseOver:e=>e.target.style.backgroundColor="#16a34a",onMouseOut:e=>e.target.style.backgroundColor="#22c55e",children:"Add New Member"})}),s&&(0,r.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fca5a5",color:"#dc2626",padding:"1rem",borderRadius:"var(--radius)",marginBottom:"1rem"},children:s}),!i&&e.length>0&&(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",marginBottom:"1rem",alignItems:"center"},children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by name or roll number",value:w,onChange:e=>C(e.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"0.6rem 0.8rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.9rem"}}),(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("label",{style:{fontSize:"0.85rem",color:"#4b5563"},children:"Order:"}),(0,r.jsxs)("select",{value:k,onChange:e=>R(e.target.value),style:{padding:"0.45rem 0.75rem",borderRadius:"var(--radius)",border:"1px solid #d1d5db",fontSize:"0.85rem",cursor:"pointer"},children:[(0,r.jsx)("option",{value:"desc",children:"Newest first"}),(0,r.jsx)("option",{value:"asc",children:"Oldest first"})]})]})})]}),i?(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading..."}):0===M.length?(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#666"},children:"No users found"}):(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",borderRadius:"var(--radius)",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{backgroundColor:"#f3f4f6",borderBottom:"2px solid #e5e7eb"},children:[(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Name"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Roll Number"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Role"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"left",fontWeight:"600"},children:"Joined Date"}),(0,r.jsx)("th",{style:{padding:"1rem",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:M.map(e=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,r.jsx)("td",{style:{padding:"1rem"},children:e.name}),(0,r.jsx)("td",{style:{padding:"1rem"},children:e.student_id}),(0,r.jsx)("td",{style:{padding:"1rem"},children:(0,r.jsx)("span",{style:{display:"inline-block",padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.875rem",fontWeight:"600",backgroundColor:"admin"===e.role?"#fef3c7":"#dbeafe",color:"admin"===e.role?"#b45309":"#1e40af"},children:"admin"===e.role?"Admin":"Member"})}),(0,r.jsx)("td",{style:{padding:"1rem",fontSize:"0.875rem"},children:new Date(e.created_at).toLocaleDateString("en-IN")}),(0,r.jsxs)("td",{style:{padding:"1rem",textAlign:"center"},children:["member"===e.role&&(0,r.jsx)("button",{onClick:()=>{p(e),b(!0),g("")},style:{backgroundColor:"#ef4444",color:"#fff",border:"none",padding:"0.5rem 1rem",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"background-color 0.2s"},onMouseOver:e=>e.target.style.backgroundColor="#dc2626",onMouseOut:e=>e.target.style.backgroundColor="#ef4444",children:"ðŸ—‘ï¸ Remove"}),"admin"===e.role&&(0,r.jsx)("span",{style:{color:"#999",fontSize:"0.875rem"},children:"Cannot delete admin"})]})]},e.id))})]})}),u&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,r.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"var(--radius)",padding:"2rem",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)"},children:[(0,r.jsx)("h2",{style:{marginBottom:"1rem",color:"#1f2937"},children:"Remove Member"}),(0,r.jsxs)("p",{style:{color:"#666",marginBottom:"1.5rem"},children:["Are you sure you want to remove ",(0,r.jsx)("strong",{children:h?.name}),"? This action cannot be undone."]}),s&&(0,r.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fca5a5",color:"#dc2626",padding:"0.75rem 1rem",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem"},children:s}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"Admin Password:"}),(0,r.jsx)("input",{type:"password",value:m,onChange:e=>g(e.target.value),placeholder:"Enter admin password",disabled:f,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"1rem",boxSizing:"border-box"}})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[(0,r.jsx)("button",{onClick:()=>b(!1),disabled:f,style:{backgroundColor:"#e5e7eb",color:"#1f2937",border:"none",padding:"0.75rem 1.5rem",borderRadius:"var(--radius)",cursor:f?"not-allowed":"pointer",fontWeight:"500",opacity:f?.6:1},children:"Cancel"}),(0,r.jsx)("button",{onClick:N,disabled:f,style:{backgroundColor:"#ef4444",color:"#fff",border:"none",padding:"0.75rem 1.5rem",borderRadius:"var(--radius)",cursor:f?"not-allowed":"pointer",fontWeight:"500",opacity:f?.6:1},children:f?"Removing...":"Remove Member"})]})]})}),y&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,r.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"var(--radius)",padding:"2rem",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)"},children:[(0,r.jsx)("h2",{style:{marginBottom:"1rem",color:"#1f2937"},children:"Add New Member"}),s&&(0,r.jsx)("div",{style:{backgroundColor:"#fee2e2",border:"1px solid #fca5a5",color:"#dc2626",padding:"0.75rem 1rem",borderRadius:"var(--radius)",marginBottom:"1rem",fontSize:"0.875rem"},children:s}),(0,r.jsxs)("div",{style:{display:"grid",gap:"1rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"Name:"}),(0,r.jsx)("input",{type:"text",value:v.name,onChange:e=>S({...v,name:e.target.value}),placeholder:"Enter member name",disabled:z,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"1rem",boxSizing:"border-box"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"Roll Number:"}),(0,r.jsx)("input",{type:"text",value:v.student_id,onChange:e=>S({...v,student_id:e.target.value}),placeholder:"Enter roll number",disabled:z,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"1rem",boxSizing:"border-box"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"Password:"}),(0,r.jsx)("input",{type:"password",value:v.password,onChange:e=>S({...v,password:e.target.value}),placeholder:"Enter password",disabled:z,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"var(--radius)",fontSize:"1rem",boxSizing:"border-box"}})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"1.5rem"},children:[(0,r.jsx)("button",{onClick:()=>j(!1),disabled:z,style:{backgroundColor:"#e5e7eb",color:"#1f2937",border:"none",padding:"0.75rem 1.5rem",borderRadius:"var(--radius)",cursor:z?"not-allowed":"pointer",fontWeight:"500",opacity:z?.6:1},children:"Cancel"}),(0,r.jsx)("button",{onClick:T,disabled:z,style:{backgroundColor:"#22c55e",color:"#fff",border:"none",padding:"0.75rem 1.5rem",borderRadius:"var(--radius)",cursor:z?"not-allowed":"pointer",fontWeight:"500",opacity:z?.6:1},children:z?"Adding...":"Add Member"})]})]})}),(0,r.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,r.jsx)("a",{href:"/access-logs",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500",marginRight:"2rem"},children:"â†’ View Access Logs"}),(0,r.jsx)("a",{href:"/",style:{color:"#3b82f6",textDecoration:"none",fontWeight:"500"},children:"â† Back to Dashboard"})]})]}):null}e.s(["default",()=>o])}]);